import{j as e,C as t,e as n,T as r}from"./mui-vendor-B_Gf3d1M.js";import{a as s}from"./react-vendor-4ga91NY9.js";import{h as o,V as i,F as a,G as l,g as d,L as c,i as p,P as u,b as h,c as y,E as f,j as g,d as x,e as b,f as m,k as v}from"./three-vendor-TblYD1mt.js";import"./chart-vendor-_GeZekKK.js";const j=s.memo(({eventLogs:s=[]})=>e.jsx(t,{elevation:0,sx:{minWidth:350,width:300,bgcolor:"#f0edfd",color:"#000",border:"1px solid #d0c9f0",borderRadius:"20px",display:"flex",flexDirection:"column",flexShrink:0,height:"100%"},children:e.jsxs(n,{sx:{p:2,display:"flex",flexDirection:"column",gap:2,flex:1,minHeight:0},children:[e.jsx(r,{variant:"subtitle1",sx:{fontWeight:700,color:"#39306b",mb:1},children:"이벤트 로그"}),e.jsx("div",{style:{flex:1,overflowY:"auto",minHeight:0},children:0===s.length?e.jsx("div",{style:{color:"#666",fontSize:"14px",padding:"10px"},children:"노드를 클릭하면 이벤트 로그가 표시됩니다."}):s.map((s,o)=>e.jsxs("div",{style:{padding:"10px",marginBottom:"8px",background:"rgba(57, 48, 107, 0.1)",borderRadius:"8px",fontSize:"13px",color:"#333"},children:[s.message&&e.jsx("div",{style:{fontWeight:600,marginBottom:"4px",color:"#222"},children:s.message}),s.nodeInfo&&e.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"4px"},children:["Layer: ",s.nodeInfo.layer," | Type: ",s.nodeInfo.type]}),void 0!==s.connectedCount&&e.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px",color:"#222"},children:["연결된 노드 개수: ",s.connectedCount,Array.isArray(s.connectedIps)&&s.connectedIps.length>0&&e.jsxs("details",{style:{marginTop:"4px",color:"#222"},children:[e.jsx("summary",{style:{cursor:"pointer",color:"#1976d2",fontWeight:"bold"},children:"연결된 노드 IP 목록 보기"}),e.jsx("ul",{style:{margin:0,paddingLeft:16},children:s.connectedIps.map((t,n)=>e.jsx("li",{style:{color:"#222"},children:t},t+n))})]})]}),Array.isArray(s.dbInfo)&&s.dbInfo.length>0&&s.dbInfo.map((s,o)=>e.jsx(t,{elevation:0,sx:{bgcolor:"rgba(255,255,255,0.6)",border:"1px solid rgba(124,58,237,0.18)",borderRadius:2,mt:1},children:e.jsxs(n,{sx:{py:1.25,px:1.5},children:[s.src_IP&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx(r,{variant:"subtitle2",sx:{color:"#3b2c6b",fontWeight:700,mb:.5},children:"Source IP"}),e.jsx("ul",{style:{margin:0,paddingLeft:16},children:Object.entries(s.src_IP).filter(([e])=>["subnet","ip","__labels","id"].includes(e)).map(([t,n])=>e.jsxs("li",{style:{color:"#2a2050"},children:[e.jsxs("b",{style:{color:"#6553a7"},children:[t,":"]})," ",String(n)]},t))})]}),s.dst_IP&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx(r,{variant:"subtitle2",sx:{color:"#3b2c6b",fontWeight:700,mb:.5},children:"Destination IP"}),e.jsx("ul",{style:{margin:0,paddingLeft:16},children:Object.entries(s.dst_IP).filter(([e])=>["ip","__labels","id"].includes(e)).map(([t,n])=>e.jsxs("li",{style:{color:"#2a2050"},children:[e.jsxs("b",{style:{color:"#6553a7"},children:[t,":"]})," ",String(n)]},t))})]}),s.edge&&e.jsxs("div",{children:[e.jsx(r,{variant:"subtitle2",sx:{color:"#3b2c6b",fontWeight:700,mb:.5},children:"Edge Info"}),e.jsx("ul",{style:{margin:0,paddingLeft:16},children:Object.entries(s.edge).map(([t,n])=>e.jsxs("li",{style:{color:"#2a2050"},children:[e.jsxs("b",{style:{color:"#6553a7"},children:[t,":"]})," ",String(n)]},t))})]})]})},o))]},o))})]})}));j.displayName="InternalLog";var w={};const k=["up","down","unknown"],_={physical:"#3BA3FF",logical:"#9B6BFF",persona:"#FF9E3B"},S=800,I=-600,E=0,C=600,L=2e3,A=1400,z={CONNECTS_TO:"#A0AEC0",CONNECTED:"#A0AEC0",HOSTS:"#60A5FA",USES:"#F59E0B",IN_SUBNET:"#93C5FD",IN_VLAN:"#C084FC",MEMBER_OF:"#FBBF24"},P="undefined"!=typeof process&&w&&w.REACT_APP_API_BASE||"http://localhost:8000";function R(e){const t=(e.__labels||[]).map(e=>String(e).toLowerCase());let n=e.layer&&String(e.layer).toLowerCase()||(t.includes("persona")?"persona":t.includes("logical")||t.includes("service")||t.includes("subnet")||t.includes("vlan")?"logical":(t.includes("physical")||t.includes("device")||t.includes("host"),"physical")),r=(e.type||t[0]||"device").toString().toLowerCase(),s=e.label||e.hostname||e.name||e.user_name||e.service_name||e.subnet||e.ip||e.id;return s||void 0===e.vlan||(s=`VLAN-${e.vlan}`),{id:e.id,layer:n,type:r,label:s||String(e.id||""),status:e.status||"up",severity:"number"==typeof e.severity?e.severity:0,ip:e.ip,hostname:e.hostname,os:e.os,subnet:e.subnet,service_name:e.service_name,proto:e.proto,port:e.port,vlan:e.vlan,user_name:e.user_name,role:e.role,dept:e.dept,device_ids:e.device_ids||[],tags:e.tags||[],x:(Math.random()-.5)*L*.9,y:(Math.random()-.5)*A*.9,z:"persona"===n?C:"logical"===n?E:I}}function M(e){if(!e)return null;let t=e.kind||e.rel||e.type||"CONNECTS_TO";return"CONNECTED"===t&&(t="CONNECTS_TO"),{source:e.sourceIP,target:e.targetIP,kind:t,assumed:Boolean(e.assumed),confidence:"number"==typeof e.confidence?e.confidence:void 0,__sid:e.sourceIP,__tid:e.targetIP}}function F({selected:t,adj:n,visible:r,byId:s,onClearSelection:o,onResetView:i}){return t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{padding:16,borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:12,color:"#fff"},children:"기본 정보"}),e.jsxs("div",{style:{display:"grid",rowGap:6,color:"#e5e7eb",fontSize:13},children:[e.jsxs("div",{children:[e.jsx("b",{children:"ID:"})," ",e.jsx("span",{style:{wordBreak:"break-all"},children:t.id})]}),e.jsxs("div",{children:[e.jsx("b",{children:"Layer:"})," ",t.layer]}),e.jsxs("div",{children:[e.jsx("b",{children:"Type:"})," ",t.type]}),e.jsxs("div",{children:[e.jsx("b",{children:"Label:"})," ",t.label]}),e.jsxs("div",{children:[e.jsx("b",{children:"Status:"})," ",t.status]}),e.jsxs("div",{children:[e.jsx("b",{children:"Severity:"})," ",t.severity]}),Array.isArray(t.tags)&&t.tags.length>0&&e.jsxs("div",{children:[e.jsx("b",{children:"Tags:"})," ",t.tags.join(", ")]})]})]}),e.jsx(B,{selectedId:t.id,visible:r,adj:n,byId:s}),e.jsxs("div",{style:{padding:12,borderTop:"1px solid rgba(255,255,255,0.1)",display:"flex",gap:8},children:[e.jsx("button",{onClick:o,style:{padding:"4px 8px",background:"#374151",color:"#fff",border:"none",borderRadius:6},children:"선택 해제"}),e.jsx("button",{onClick:i,style:{padding:"4px 8px",background:"#374151",color:"#fff",border:"none",borderRadius:6},children:"전체 보기"})]})]}):e.jsxs("div",{style:{padding:16,color:"#d1d5db",fontSize:14},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"선택된 노드가 없습니다"}),"노드를 클릭하면 상세 정보와 연결 리스트가 여기에 표시됩니다."]})}function B({selectedId:t,visible:n,byId:r,adj:s}){return e.jsxs("div",{style:{padding:16,flex:1,overflow:"auto"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:8,color:"#fff"},children:"동일 레이어 연결"}),e.jsx(T,{listType:"same",selectedId:t,visible:n,byId:r,adj:s}),e.jsx("div",{style:{height:12}}),e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:8,color:"#fff"},children:"교차 레이어 연결"}),e.jsx(T,{listType:"cross",selectedId:t,visible:n,byId:r,adj:s})]})}function T({listType:t,selectedId:n,visible:r,byId:s,adj:o}){const i=[];return n&&s[n]&&(o.get(n)||[]).forEach(e=>{const o=r.links.find(t=>{const r=t.__sid||("object"==typeof t.source?t.source.id:t.source),s=t.__tid||("object"==typeof t.target?t.target.id:t.target);return r===n&&s===e||s===n&&r===e}),a=s[e];if(!o||!a)return;const l=a.layer!==s[n].layer;("same"===t&&!l||"cross"===t&&l)&&i.push({l:o,other:a})}),i.length?e.jsx("div",{children:i.map((t,n)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px solid rgba(55,65,81,0.5)",fontSize:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:4,background:_[t.other.layer]}}),e.jsx("span",{style:{color:"#e5e7eb"},children:t.other.label}),e.jsxs("span",{style:{color:"#9ca3af"},children:["(",t.other.type,")"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[t.l.assumed&&e.jsx("span",{style:{background:"#374151",color:"#e5e7eb",padding:"2px 6px",borderRadius:4,fontSize:10},children:"assumed"}),e.jsx("span",{style:{color:"#9ca3af"},children:t.l.kind})]})]},n))}):e.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:"없음"})}function D({onNodeSelect:r=()=>{},onInspectorChange:w=()=>{}}){const B=s.useRef(),T=s.useRef(null),D=s.useRef(null),[O,N]=s.useState({width:0,height:0}),[W,$]=s.useState({nodes:[],links:[]}),[Y,X]=s.useState(!1),[Z,H]=s.useState(null),[U,V]=s.useState(!0),[q,G]=s.useState(""),[Q,J]=s.useState({physical:!0,logical:!0,persona:!0}),[K,ee]=s.useState("all"),[te,ne]=s.useState(new Set(k)),[re,se]=s.useState([]),{byId:oe,adj:ie}=s.useMemo(()=>function(e,t){const n=Object.fromEntries(e.map(e=>[e.id,e])),r=new Map;return e.forEach(e=>r.set(e.id,new Set)),t.forEach(e=>{const t="object"==typeof e.source?e.source.id:e.source,s="object"==typeof e.target?e.target.id:e.target;r.has(t)&&r.get(t).add(s),r.has(s)&&r.get(s).add(t),e.__sid=t,e.__tid=s,e.__s=n[t],e.__t=n[s]}),{byId:n,adj:r}}(W.nodes,W.links),[W]);s.useEffect(()=>{const e=B.current;if(!e)return;const t=e.controls&&e.controls();if(t){t.enableRotate=!1,t.enablePan=!1,t.enableZoom=!0;try{t.mouseButtons={LEFT:o.ROTATE,MIDDLE:o.DOLLY,RIGHT:o.PAN}}catch(r){}t.minPolarAngle=1e-6,t.maxPolarAngle=1e-6}e.cameraPosition({x:0,y:1800,z:0},{x:0,y:0,z:0},0);const n=e.scene();n.rotation.order="YXZ",n.rotation.set(0,0,0,"YXZ"),(()=>{const e=B.current?.scene?.();if(!e)return;const t=e.getObjectByName("layer-planes");t&&e.remove(t);const n=new l;n.name="layer-planes";const r=(e,t,r)=>{const s=new u(L,A,1,1),o=new h({color:t,transparent:!0,opacity:.06,depthWrite:!1}),i=new y(s,o);i.position.set(0,0,e);const a=new f(s),l=new g(a,new p({color:t,transparent:!0,opacity:.25}));l.position.set(0,0,e+.1);const d=document.createElement("canvas");d.width=512,d.height=128;const c=d.getContext("2d");c.fillStyle="rgba(0,0,0,0)",c.fillRect(0,0,512,128),c.font="40px sans-serif",c.fillStyle="#ffffff",c.textAlign="left",c.textBaseline="middle",c.fillText(r,14,64);const v=new x(d),j=new b({map:v,transparent:!0,opacity:.9,depthWrite:!1}),w=new m(j);w.scale.set(320,80,1),w.position.set(-820,A/2-80,e+.2),n.add(i),n.add(l),n.add(w)};r(I,_.physical,"Physical"),r(E,_.logical,"Logical"),r(C,_.persona,"Persona"),e.add(n)})(),(()=>{const e=B.current?.scene?.(),t=e?.getObjectByName("layer-planes");t&&(t.visible=!0)})()},[]),s.useEffect(()=>{const e=B.current;if(e){try{e.d3Force("charge")&&e.d3Force("charge").strength(0)}catch{}try{e.d3Force("link")&&e.d3Force("link").strength(()=>.05)}catch{}}},[]),s.useEffect(()=>{let e=!0;return(async()=>{try{e&&V(!0)}catch(t){}try{const t=function(e){const t=new Map,n=[];for(const a of e){const e=a.src_IP||a.n||a.source,r=a.dst_IP||a.t||a.target,s=a.edge||a.r;if(!e||!r)continue;const o=e.id,i=r.id;if(!o||!i)continue;t.has(o)||t.set(o,R(e)),t.has(i)||t.set(i,R(r));const l=M(s);l&&n.push(l)}const r=[...t.values()],s=r.filter(e=>"subnet"===e.type),o=r.filter(e=>"physical"===e.layer),i=new Map;return s.forEach((e,t)=>{const n=t/Math.max(1,s.length)*Math.PI*2;i.set(e.subnet||e.label||e.id,{cx:420*Math.cos(n),cy:420*Math.sin(n)})}),o.forEach(e=>{const t=e.subnet||e.label,n=i.get(t);n&&(e.x=n.cx+50*(Math.random()-.5),e.y=n.cy+50*(Math.random()-.5))}),{nodes:r,links:n}}(await async function(){const e=`${P}/neo4j/nodes?activeView=multilayer&project=${encodeURIComponent("multi-layer")}`,t=await fetch(e);if(!t.ok)throw new Error(`API multilayer 실패: ${t.status}`);return t.json()}());e&&$(t)}catch(t){e&&$(function(){const e=[],t=[];for(let n=0;n<30;n++)e.push({id:`dev-${n}`,layer:"physical",type:"server",label:`DEV-${n}`,status:"up",severity:0,x:(Math.random()-.5)*S,y:(Math.random()-.5)*S,z:I});for(let n=0;n<10;n++)e.push({id:`svc-${n}`,layer:"logical",type:"service",label:`SVC-${n}`,status:"up",severity:0,x:(Math.random()-.5)*S,y:(Math.random()-.5)*S,z:E});for(let n=0;n<10;n++)e.push({id:`user-${n}`,layer:"persona",type:"user",label:`USER-${n}`,status:"up",severity:0,x:(Math.random()-.5)*S,y:(Math.random()-.5)*S,z:C});for(let n=0;n<80;n++)t.push({source:`dev-${Math.floor(30*Math.random())}`,target:`svc-${Math.floor(10*Math.random())}`,kind:"HOSTS"});for(let n=0;n<80;n++)t.push({source:`user-${Math.floor(10*Math.random())}`,target:`svc-${Math.floor(10*Math.random())}`,kind:"USES"});return{nodes:e,links:t}}())}finally{e&&V(!1)}})(),()=>{e=!1}},[]),s.useEffect(()=>{const e=()=>{try{B.current&&B.current.zoomToFit(600,40)}catch{}};(W.nodes?.length||W.links?.length)&&requestAnimationFrame(e);const t=T.current;let n;return t&&"undefined"!=typeof ResizeObserver?(n=new ResizeObserver(()=>requestAnimationFrame(e)),n.observe(t)):window.addEventListener("resize",e),()=>{n&&t&&n.unobserve(t),window.removeEventListener("resize",e)}},[W]),s.useEffect(()=>{const e=D.current;if(!e)return;const t=()=>{try{N({width:e.clientWidth||0,height:e.clientHeight||0})}catch{}};let n;if(t(),"undefined"!=typeof ResizeObserver){n=new ResizeObserver(()=>t());try{n.observe(e)}catch{}}else window.addEventListener("resize",t);return()=>{try{n&&e&&n.unobserve(e)}catch{}window.removeEventListener("resize",t)}},[]),s.useEffect(()=>{const e=B.current;if(!e)return;const t=e.renderer().domElement,n=e.scene(),r=Math.PI/6,s=1/0,o=Math.PI/60,a=()=>{n.rotation.x=v.clamp(n.rotation.x,-1.3,1.3),n.rotation.y=v.clamp(n.rotation.y,-r,r),n.rotation.z=v.clamp(n.rotation.z,-1/0,s),n.rotation.order="YXZ"};let l=!1,d=0,c=0,p=!1;const u=e=>e.clientX??(e.touches&&e.touches[0]?.clientX)??0,h=e=>e.clientY??(e.touches&&e.touches[0]?.clientY)??0,y=e=>{if(!l)return;const t=u(e),r=h(e),s=t-d,o=r-c;d=t,c=r,p?n.rotation.z+=.006*s:(n.rotation.y+=.006*s,n.rotation.x+=.005*o),a()},f=()=>{l=!1},g=e=>{try{if(("mouse"===e.pointerType||"number"==typeof e.button)&&2===e.button){try{e.preventDefault(),e.stopPropagation()}catch(t){}return}}catch(t){}l=!0,d=u(e),c=h(e)};t.addEventListener("pointerdown",g,{capture:!0});const x=e=>{try{e.preventDefault()}catch(t){}};t.addEventListener("contextmenu",x),window.addEventListener("pointermove",y),window.addEventListener("pointerup",f),t.addEventListener("pointerleave",f);const b=new i(1,1,1).normalize(),m=e=>{let t=!0;switch(e.key){case"ArrowUp":n.rotation.x-=o;break;case"ArrowDown":n.rotation.x+=o;break;case"ArrowLeft":n.rotation.y-=o;break;case"ArrowRight":n.rotation.y+=o;break;case"z":case"Z":n.rotation.z-=o;break;case"x":case"X":n.rotation.z+=o;break;case"r":case"R":n.rotation.set(0,0,0,"YXZ");break;case"u":case"U":n.rotateOnWorldAxis(b,+o),n.rotation.setFromQuaternion(n.quaternion,"YXZ");break;case"i":case"I":n.rotateOnWorldAxis(b,-o),n.rotation.setFromQuaternion(n.quaternion,"YXZ");break;default:t=!1}t&&a()},j=e=>{if("Space"===e.code||" "===e.key){p=!0;try{e.preventDefault()}catch{}}},w=e=>{if("Space"===e.code||" "===e.key){p=!1;try{e.preventDefault()}catch{}}};return window.addEventListener("keydown",m),window.addEventListener("keydown",j),window.addEventListener("keyup",w),()=>{t.removeEventListener("pointerdown",g),t.removeEventListener("contextmenu",x),window.removeEventListener("pointermove",y),window.removeEventListener("pointerup",f),t.removeEventListener("pointerleave",f),window.removeEventListener("keydown",m),window.removeEventListener("keydown",j),window.removeEventListener("keyup",w)}},[]);const ae=s.useMemo(()=>{const e=new Set(W.nodes.filter(e=>{if(!Q[e.layer])return!1;if(q){const t=q.toLowerCase();if(![e.label,e.ip,e.user_name,e.role,e.dept,e.hostname,e.service_name,e.subnet,e.type].filter(Boolean).join(" ").toLowerCase().includes(t))return!1}return!0}).map(e=>e.id)),t=W.links.filter(t=>{const n=t.__sid||("object"==typeof t.source?t.source.id:t.source),r=t.__tid||("object"==typeof t.target?t.target.id:t.target);if(!e.has(n)||!e.has(r))return!1;if("all"!==K&&!!t.assumed!=("true"===K))return!1;const s=oe[n],o=oe[r];return!(s&&o&&(!te.has(s.status)||!te.has(o.status)))}),n=new Set;return t.forEach(e=>{const t=e.__sid||("object"==typeof e.source?e.source.id:e.source),r=e.__tid||("object"==typeof e.target?e.target.id:e.target);n.add(t),n.add(r)}),{nodes:W.nodes.filter(t=>e.has(t.id)&&(n.has(t.id)||!q)),links:t}},[W,Q,K,te,q,oe]),le=s.useMemo(()=>{if(!Z)return{nodes:new Set,links:new Set};const e=new Set([Z]),t=new Set;return(ie.get(Z)||[]).forEach(t=>e.add(t)),ae.links.forEach(n=>{const r=n.__sid||("object"==typeof n.source?n.source.id:n.source),s=n.__tid||("object"==typeof n.target?n.target.id:n.target);e.has(r)&&e.has(s)&&t.add(n)}),{nodes:e,links:t}},[Z,ae,ie]),de=e=>Z&&!le.links.has(e),ce=e=>{const t=new d(z[e.kind]||"#A0AEC0");return`#${(de(e)?t.lerp(new d("#2A2A2A"),.6):t).getHexString()}`},pe=()=>{H(null),r(null),w(null),se([])},ue=()=>{H(null),r(null);const e=B.current;if(e){try{const t=e.scene().rotation;t.order="YXZ",t.x=0,t.y=0,t.z=0}catch{}e.cameraPosition({x:0,y:1800,z:0},{x:0,y:0,z:0},600)}},he=t=>{if(H(t?.id||null),t){const s=e.jsx(F,{selected:t,adj:ie,visible:ae,byId:oe,onClearSelection:pe,onResetView:ue});r(s);try{w(s)}catch(n){}const o=ie.get(t.id)||new Set,i=Array.from(o).map(e=>oe[e]).filter(e=>e&&e.ip).map(e=>e.ip),a=ae.links.filter(e=>{const n=e.__sid||("object"==typeof e.source?e.source.id:e.source),r=e.__tid||("object"==typeof e.target?e.target.id:e.target);return n===t.id||r===t.id}).map(e=>{const t=e.__sid||("object"==typeof e.source?e.source.id:e.source),n=e.__tid||("object"==typeof e.target?e.target.id:e.target),r=oe[t],s=oe[n];return{src_IP:r?{id:r.id,ip:r.ip,__labels:[r.layer,r.type],__id:r.id,index:r.index}:null,dst_IP:s?{id:s.id,ip:s.ip,__labels:[s.layer,s.type],__id:s.id,index:s.index}:null,edge:{sourceIP:t,targetIP:n,kind:e.kind,assumed:e.assumed,confidence:e.confidence}}}),l={message:`노드 선택: ${t.label||t.id}`,nodeInfo:{layer:t.layer,type:t.type,ip:t.ip},connectedCount:o.size,connectedIps:i,dbInfo:a};se([l])}else r(null),w(null),se([])},ye=s.useMemo(()=>{if(Y)return ae;if(!Z)return{nodes:ae.nodes,links:[]};const e=new Set([Z]);(ie.get(Z)||[]).forEach(t=>e.add(t));const t=ae.links.filter(t=>{const n=t.__sid||("object"==typeof t.source?t.source.id:t.source),r=t.__tid||("object"==typeof t.target?t.target.id:t.target);return e.has(n)||e.has(r)});return{nodes:ae.nodes,links:t}},[Y,ae,Z,ie]);return e.jsx(t,{ref:T,sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",borderRadius:2,boxShadow:3,overflow:"hidden"},children:e.jsxs(n,{sx:{p:2,height:"100%",display:"flex",gap:2},children:[e.jsx("div",{style:{flex:1,minWidth:0,height:"100%"},children:e.jsx("div",{style:{width:"100%",height:"100%",minHeight:600,color:"#fff",display:"flex",flexDirection:"row"},children:e.jsx(t,{sx:{flex:1,position:"relative",overflow:"hidden",borderRadius:"20px",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",background:"#0b1220",mr:1},children:e.jsxs("div",{ref:D,style:{width:"100%",height:"100%",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",top:12,left:12,zIndex:10,background:"rgba(57,48,107,0.7)",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:12,padding:12},children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",fontSize:12},children:[e.jsx("input",{placeholder:"검색: label, ip, user, role, dept...",value:q,onChange:e=>G(e.target.value),style:{padding:"4px 8px",borderRadius:6,border:"1px solid rgba(128,128,128,0.5)",background:"rgba(20,20,20,0.7)",color:"#fff"}}),e.jsx("span",{style:{width:1,height:24,background:"rgba(255,255,255,0.1)"}}),["physical","logical","persona"].map(t=>e.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("input",{type:"checkbox",checked:Q[t],onChange:e=>J(n=>({...n,[t]:e.target.checked}))}),e.jsxs("span",{style:{display:"inline-flex",gap:6,alignItems:"center"},children:[e.jsx("span",{style:{width:10,height:10,borderRadius:2,background:_[t]}}),e.jsx("span",{children:t})]})]},t)),e.jsx("span",{style:{width:1,height:24,background:"rgba(255,255,255,0.1)"}}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:"assumed"}),e.jsxs("select",{value:K,onChange:e=>ee(e.target.value),style:{background:"rgba(20,20,20,0.7)",color:"#fff",border:"1px solid rgba(128,128,128,0.5)",borderRadius:6,padding:"2px 4px"},children:[e.jsx("option",{value:"all",children:"all"}),e.jsx("option",{value:"true",children:"true"}),e.jsx("option",{value:"false",children:"false"})]})]}),e.jsx("span",{style:{width:1,height:24,background:"rgba(255,255,255,0.1)"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:"status"}),k.map(t=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:te.has(t),onChange:e=>{const n=new Set(te);e.target.checked?n.add(t):n.delete(t),ne(n)}}),e.jsx("span",{style:{textTransform:"uppercase"},children:t})]},t))]}),e.jsx("span",{style:{width:1,height:24,background:"rgba(255,255,255,0.1)"}}),e.jsx("button",{onClick:()=>X(e=>!e),style:{padding:"4px 8px",borderRadius:6,background:Y?"#3b82f6":"#F0EDFD",color:"#000",border:"1px solid rgba(128,128,128,0.5)"},children:Y?"펄스 ON":"펄스 OFF"}),e.jsx("button",{onClick:()=>{G(""),J({physical:!0,logical:!0,persona:!0}),ee("all"),ne(new Set(k))},style:{padding:"4px 8px",borderRadius:6,background:"#F0EDFD",color:"#000",border:"1px solid rgba(128,128,128,0.5)"},children:"필터 초기화"}),e.jsx("button",{onClick:ue,style:{padding:"4px 8px",borderRadius:6,background:"#F0EDFD",color:"#000",border:"1px solid rgba(128,128,128,0.5)"},children:"뷰 초기화"})]})}),e.jsx(a,{ref:B,graphData:ye,backgroundColor:"#0b1220",width:O.width,height:O.height,nodeAutoColorBy:null,nodeColor:e=>Z&&(e=>Z&&!le.nodes.has(e.id))(e)?"#2A2A2A":_[e.layer]||"#B0B0B0",nodeLabel:e=>`${e.label} (layer: ${e.layer})`,nodeRelSize:5.2,linkColor:ce,linkWidth:e=>de(e)?.3:e.assumed?.6:1.5,linkMaterial:e=>{const t=new d(ce(e));if(e.assumed)try{return new c({color:t,dashSize:2,gapSize:1,transparent:!0,opacity:de(e)?.25:.65})}catch{return new p({color:t,transparent:!0,opacity:de(e)?.25:.65})}return new p({color:t,transparent:!0,opacity:de(e)?.25:.95})},linkDirectionalParticles:e=>{if(!Y||!Z)return 0;const t=e.source,n=e.target;return t&&n&&void 0!==t.id&&void 0!==n.id?t.id!==Z&&n.id!==Z||(r=n,t.layer===r.layer)?0:2:0;var r},linkDirectionalParticleWidth:()=>2,linkDirectionalParticleSpeed:()=>.006+.004*Math.random(),onNodeClick:he,onBackgroundClick:pe,onLinkClick:e=>{const t=e.__sid||("object"==typeof e.source?e.source.id:e.source),n=oe[t];n&&he(n)},onLinkUpdate:(e,t)=>{try{const n=e.__lineObj||t;n&&n.computeLineDistances&&n.computeLineDistances()}catch{}},cooldownTicks:0,enableNodeDrag:!1,showNavInfo:!1}),U&&e.jsx("div",{style:{position:"absolute",left:0,top:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:e.jsx("div",{style:{background:"rgba(0,0,0,0.6)",color:"#fff",padding:"12px 18px",borderRadius:8,backdropFilter:"blur(4px)"},children:"Loading…"})})]})})})}),e.jsx(j,{eventLogs:re})]})})}export{D as default};
