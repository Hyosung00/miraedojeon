import{j as e,I as s}from"./mui-vendor-DRsyA_VI.js";import{u as r}from"./react-vendor-CP5_hn_0.js";import{R as i}from"./index-Ce-G03_i.js";import"./chart-vendor-BJu2iTGG.js";import"./three-vendor-C8Ar5e6p.js";function t({logs:t,selectedNode:l}){const o=Array.isArray(t)?t:[],n=r();return e.jsx(e.Fragment,{children:o.map((r,t)=>e.jsxs("div",{className:`packet-log ${r.type||""}`,style:{color:"#222"},children:[r.message&&e.jsx("div",{style:{color:"#222"},children:r.message}),void 0!==r.connectedCount&&e.jsxs("div",{className:`packet-log ${r.type||""}`,style:{marginBottom:"16px",color:"#222"},children:["연결된 노드 개수: ",r.connectedCount,Array.isArray(r.connectedIps)&&r.connectedIps.length>0&&e.jsxs("details",{style:{marginTop:"4px",color:"#222"},children:[e.jsx("summary",{style:{cursor:"pointer",color:"#1976d2",fontWeight:"bold"},children:"연결된 노드 IP 목록 보기"}),e.jsx("ul",{style:{margin:0,paddingLeft:16},children:r.connectedIps.map((s,r)=>e.jsx("li",{style:{color:"#222"},children:s},s+r))})]})]},t),Array.isArray(r.dbInfo)&&r.dbInfo.length>0&&r.dbInfo.map((r,t)=>e.jsxs("div",{style:{margin:"8px 0",background:"rgba(255,255,255,0.6)",border:"1px solid rgba(124,58,237,0.18)",borderRadius:10,padding:"12px",color:"#222",position:"relative"},children:[e.jsx(s,{size:"small","aria-label":"대응 효과 분석으로 이동",title:"대응 효과 분석",disabled:!l,onClick:()=>{l&&n("/ActiveResponse/responseeffectvisualization",{state:{selectedNode:l,dbInfo:r}})},sx:{position:"absolute",top:8,right:8,color:l?"#39306b":"#ccc",bgcolor:l?"rgba(57,48,107,0.08)":"rgba(200,200,200,0.12)",border:"1px solid #bdb4e6",cursor:l?"pointer":"not-allowed","&:hover":l?{bgcolor:"rgba(57,48,107,0.18)",color:"#2a1f5a"}:{},width:24,height:24},children:e.jsx(i,{style:{fontSize:13}})}),r.src_IP&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("strong",{style:{color:"#3b2c6b"},children:"Source IP"}),e.jsx("ul",{style:{margin:0,paddingLeft:16,marginTop:6},children:Object.entries(r.src_IP).filter(([e])=>["ip","__labels","__id","id","index"].includes(e)).map(([s,r])=>e.jsxs("li",{style:{color:"#2a2050"},children:[e.jsxs("b",{style:{color:"#6553a7"},children:[s,":"]})," ",String(r)]},s))})]}),r.dst_IP&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("strong",{style:{color:"#3b2c6b"},children:"Destination IP"}),e.jsx("ul",{style:{margin:0,paddingLeft:16,marginTop:6},children:Object.entries(r.dst_IP).filter(([e])=>["ip","__labels","__id","id","__indexColor","color","index"].includes(e)).map(([s,r])=>e.jsxs("li",{style:{color:"#2a2050"},children:[e.jsxs("b",{style:{color:"#6553a7"},children:[s,":"]})," ",String(r)]},s))})]}),r.edge&&e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#3b2c6b"},children:"Edge Info"}),e.jsx("ul",{style:{margin:0,paddingLeft:16,marginTop:6},children:Object.entries(r.edge).map(([s,r])=>e.jsxs("li",{style:{color:"#2a2050"},children:[e.jsxs("b",{style:{color:"#6553a7"},children:[s,":"]})," ",String(r)]},s))})]})]},t))]},t))})}function l({logs:s}){const r=Array.isArray(s)?s:[];return e.jsx(e.Fragment,{children:r.map((s,r)=>e.jsx("div",{className:`packet-log ${s.type||""}`,children:s.message&&e.jsx("div",{children:s.message})},r))})}function o({logs:s}){const r=Array.isArray(s)?s:[];return e.jsx(e.Fragment,{children:r.map((s,r)=>e.jsx("div",{className:`packet-log ${s.type||""}`,children:s.message&&e.jsx("div",{children:s.message})},r))})}function n({logs:s}){const r=Array.isArray(s)?s:[];return e.jsx(e.Fragment,{children:r.map((s,r)=>e.jsx("div",{className:`packet-log ${s.type||""}`,children:s.message&&e.jsx("div",{children:s.message})},r))})}const a={externalInternal:"OSINT 정보 수집",fusionDatabase:"융합 데이터베이스",visualizationPlatform:"가시화 플랫폼 구성",multiLayerVisualization:"사이버 3계층 멀티레이어 가시화",anomalyDetection:"시계열 분석 비정상 활동 탐지",externalNetworkVisualization:"네트워크 외부망 가시화",internalNetworkVisualization:"주요 시설 내부망 가시화",targetIdentification:"네트워크 구조분석 및 표적 식별",priorityVisualization:"핵심 표적 분석 및 우선순위 가시화",target:"후보/핵심 표적 상세 가시화",threatExposure:"위협 노출도 및 공격 가능도 측정",responseEffectVisualization:"능동대응책 효과/경로 가시화"};function c({logs:s,activeView:r,selectedNode:i}){const c=a[r]||"Event Log",d=Array.isArray(s)?s:[];return e.jsxs("div",{children:[e.jsx("h3",{className:"eventlog-title",children:c}),!s||Array.isArray(s)&&0===s.length?e.jsx("div",{className:"eventlog-empty",children:"로그가 존재하지 않음."}):"target"===r?e.jsx(t,{logs:d,selectedNode:i}):"externalInternal"===r?e.jsx(l,{logs:d}):"internalNetworkVisualization"===r?e.jsx(o,{logs:d}):"anomalyDetection"===r?e.jsx(n,{logs:d}):d.map((s,r)=>e.jsx("div",{className:`packet-log ${s.type||""}`,children:s.message&&e.jsx("div",{children:s.message})},r))]})}export{c as default};
