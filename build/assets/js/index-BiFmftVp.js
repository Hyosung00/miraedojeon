import{j as e}from"./mui-vendor-DRsyA_VI.js";import{c as n,a as s}from"./react-vendor-CP5_hn_0.js";import{e as c,n as t}from"./index-DpUKx_TW.js";import"./index-C8ymQ3WK.js";import"./chart-vendor-BJu2iTGG.js";import"./three-vendor-C8Ar5e6p.js";const i=({value:n,onChange:s})=>e.jsxs("div",{className:"condition-group",children:[e.jsx("label",{children:"연결 유형"}),e.jsxs("div",{className:"connection-type-buttons",children:[e.jsx("button",{type:"button",className:""===n?"apply-btn active":"apply-btn",onClick:()=>s(""),children:"전체"}),e.jsx("button",{type:"button",className:"direct"===n?"apply-btn active":"apply-btn",onClick:()=>s("direct"),children:"직접 연결"}),e.jsx("button",{type:"button",className:"indirect"===n?"apply-btn active":"apply-btn",onClick:()=>s("indirect"),children:"간접 연결"})]})]}),a=({filters:n,onInputChange:s})=>e.jsxs("div",{className:"basic-conditions",children:[e.jsxs("div",{className:"condition-group",children:[e.jsx("label",{children:"연결된 노드 수"}),e.jsxs("div",{className:"range-inputs",children:[e.jsx("input",{type:"number",placeholder:"최소값",value:n.minConnections,onChange:e=>s("minConnections",e.target.value),min:"0"}),e.jsx("span",{children:"~"}),e.jsx("input",{type:"number",placeholder:"최대값",value:n.maxConnections,onChange:e=>s("maxConnections",e.target.value),min:"0"})]})]}),e.jsxs("div",{className:"condition-group",children:[e.jsx("label",{children:"표적 점수 (1~100)"}),e.jsxs("div",{className:"range-inputs",children:[e.jsx("input",{type:"number",placeholder:"최소점수",value:n.minTargetScore,onChange:e=>s("minTargetScore",e.target.value),min:"0",step:"0.1"}),e.jsx("span",{children:"~"}),e.jsx("input",{type:"number",placeholder:"최대점수",value:n.maxTargetScore,onChange:e=>s("maxTargetScore",e.target.value),min:"0",step:"0.1"})]})]})]}),o=({showAdvanced:s,availableTypes:c,filters:t,onTypeToggle:i})=>s&&e.jsxs("div",{className:"label-checkboxes",children:[e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"layer-title layer2",children:"2계층"}),e.jsx("div",{className:"layer-checkboxes",children:["switch","router"].filter(e=>c.includes(e)).map(n=>e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:t.nodeTypes&&t.nodeTypes.includes(n),onChange:()=>i(n)}),e.jsx("span",{children:n})]},n))})]}),e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"layer-title layer3",children:"3계층"}),e.jsx("div",{className:"layer-checkboxes",children:["firewall","router","server","workstation","printer","laptop"].filter(e=>c.includes(e)).map(n=>e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:t.nodeTypes&&t.nodeTypes.includes(n),onChange:()=>i(n)}),e.jsx("span",{children:n})]},n))})]}),e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"layer-title layer4",children:"4계층"}),e.jsx("div",{className:"layer-checkboxes",children:["plc","sensor"].filter(e=>c.includes(e)).map(n=>e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:t.nodeTypes&&t.nodeTypes.includes(n),onChange:()=>i(n)}),e.jsx("span",{children:n})]},n))})]})]}),r=({onConditionChange:r,data:l})=>{n.useEffect(()=>{r&&r(d,u(l,d))},[]);const[d,p]=s.useState({minConnections:"",minTargetScore:"",maxConnections:"",maxTargetScore:"",nodeTypes:[],connectionType:"",isActive:!1}),[m,h]=s.useState(!0),x=n.useMemo(()=>l?c(l):["Internal","External","Server","Client","Router","Switch"],[l]),u=(e,n)=>{let s=e;if("direct"===n.connectionType?s=s.filter(e=>{const n=e.src_IP?.degree_score;return"number"==typeof n&&n>.5}):"indirect"===n.connectionType&&(s=s.filter(e=>{const n=e.src_IP?.degree_score;return"number"==typeof n&&n>0&&n<=.5})),n.minConnections||n.maxConnections){const c=n.minConnections?Number(n.minConnections):-1/0,t=n.maxConnections?Number(n.maxConnections):1/0;s=s.filter(n=>{let s=0;const i=n.src_IP?.ip;return!!i&&(e.forEach(e=>{e.src_IP?.ip!==i&&e.dst_IP?.ip!==i||s++}),s>=c&&s<=t)})}n.nodeTypes&&n.nodeTypes.length>0&&(s=s.filter(e=>{const s=e.src_IP?.type,c=e.dst_IP?.type;return s&&n.nodeTypes.includes(s)||c&&n.nodeTypes.includes(c)}));const c=e.map(e=>e.src_IP?.ad_score).filter(e=>"number"==typeof e),i=Math.min(...c),a=Math.max(...c);if(n.minTargetScore||n.maxTargetScore){const e=n.minTargetScore?Number(n.minTargetScore):-1/0,c=n.maxTargetScore?Number(n.maxTargetScore):1/0;s=s.filter(n=>{const s=t(n.src_IP?.ad_score,i,a);return s>=e&&s<=c})}return s},y=(e,n)=>{const s={...d,[e]:n};if(p(s),"connectionType"===e){const e={...s,isActive:!0};p(e),r&&r(e,u(l,e))}else r&&r(s,u(l,s))};return e.jsxs("div",{className:"target-condition",children:[e.jsxs("div",{className:"condition-header",children:[e.jsx("h3",{children:"노드 필터링 조건"}),e.jsx("button",{className:"toggle-advanced-btn",onClick:()=>h(!m),children:m?"간단히 보기":"고급 옵션"})]}),e.jsxs("div",{className:"condition-content",children:[e.jsx(i,{value:d.connectionType,onChange:e=>y("connectionType",e)}),e.jsx(a,{filters:d,onInputChange:y}),e.jsx(o,{showAdvanced:m,availableTypes:x,filters:d,onTypeToggle:e=>{const n=d.nodeTypes.includes(e)?d.nodeTypes.filter(n=>n!==e):[...d.nodeTypes,e];y("nodeTypes",n)}}),e.jsxs("div",{className:"condition-actions",children:[e.jsx("button",{className:"apply-btn",onClick:()=>{const e={...d,isActive:!0};p(e),r&&r(e,u(l,e))},disabled:!(d.minConnections||d.minTargetScore||d.maxConnections||d.maxTargetScore||0!==d.nodeTypes.length),children:"필터 적용"}),e.jsx("button",{className:"clear-btn",onClick:()=>{const e={minConnections:"",minTargetScore:"",maxConnections:"",maxTargetScore:"",nodeTypes:[],isActive:!1};p(e),r&&r(e,u(l,e))},children:"초기화"})]})]})]})};export{r as default};
