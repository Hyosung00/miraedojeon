const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-DZJ9HMIm.js","assets/js/mui-vendor-B_Gf3d1M.js","assets/js/react-vendor-4ga91NY9.js","assets/js/index-D0x5EnjW.js","assets/js/chart-vendor-_GeZekKK.js","assets/js/three-vendor-O1B0tc-R.js","assets/css/index-DVVUjXCO.css","assets/js/index-B1uedqw4.js","assets/js/DataTable-DQ7XxXZ2.js","assets/js/TrendChart-DvgUqEqR.js","assets/js/EventLog-DxqHPC_T.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./index-D0x5EnjW.js";import{j as t}from"./mui-vendor-B_Gf3d1M.js";import{c as s,u as a,a as r}from"./react-vendor-4ga91NY9.js";const c=s.memo(({dbTitle:e,dbValue:s,dbSubtext:a,className:r})=>{const c=e||"Default Title",d=s||"Default Value",o=a||"Default Subtext";return t.jsxs("div",{className:r,children:[t.jsx("div",{className:"statistics-card-value",children:d}),t.jsx("div",{className:"statistics-card-title",children:c}),t.jsx("div",{className:"statistics-card-subtext",children:o})]})});function d(e,t,s){return"number"!=typeof e||isNaN(e)||t===s?1:Math.round(1+99*(e-t)/(s-t))}c.displayName="StatisticsCard";const o=e=>{if(!e)return[];const t=new Set;return e.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&t.add(e.type)})}),Array.from(t).sort()},n=r.lazy(()=>e(()=>import("./index-DZJ9HMIm.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),i=r.lazy(()=>e(()=>import("./index-B1uedqw4.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),l=r.lazy(()=>e(()=>import("./DataTable-DQ7XxXZ2.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),u=r.lazy(()=>e(()=>import("./TrendChart-DvgUqEqR.js"),__vite__mapDeps([9,1,2,4]))),x=r.lazy(()=>e(()=>import("./EventLog-DxqHPC_T.js"),__vite__mapDeps([10,1,2]))),h=()=>t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#666"},children:"Loading..."}),_=Object.freeze(Object.defineProperty({__proto__:null,default:function({onNodeClick:e,data:d,logs:_=[],activeView:p="target"}){const m=a(),[b,j]=r.useState(d||[]),[g,f]=r.useState([]),[y,v]=r.useState({}),[S,N]=r.useState(_),[I,P]=r.useState(null),C=r.useMemo(()=>Array.isArray(b)?b:b?.nodes||b?.network||[],[b]),T=r.useMemo(()=>C.map(e=>({degree_score:e.src_IP?.degree_score||e.dst_IP?.degree_score||0,con_score:e.src_IP?.con_score||e.dst_IP?.con_score||0})),[C]),E=r.useMemo(()=>{const e=new Set;g.forEach(t=>{t.src_IP&&t.src_IP.ip&&e.add(t.src_IP.ip)});let t=0,s=0;e.forEach(e=>{const a=g.find(t=>t.src_IP&&t.src_IP.ip===e)?.src_IP;a&&"number"==typeof a.degree_score&&(a.degree_score>.5?t+=1:a.degree_score>0&&a.degree_score<=.5&&(s+=1))});const a={};g.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&(a[e.type]=(a[e.type]||0)+1)})});const r=[...C.map(e=>e.src_IP?.degree_score),...C.map(e=>e.dst_IP?.degree_score)].filter(e=>"number"==typeof e),c=[...C.map(e=>e.src_IP?.con_score),...C.map(e=>e.dst_IP?.con_score)].filter(e=>"number"==typeof e);return{directCurrent:t,indirectCurrent:s,typeCountMap:a,degreeScoreAvg:r.length?(r.reduce((e,t)=>e+t,0)/r.length).toFixed(3):"-",degreeScoreMax:r.length?Math.max(...r).toFixed(3):"-",conScoreAvg:c.length?(c.reduce((e,t)=>e+t,0)/c.length).toFixed(3):"-",conScoreMax:c.length?Math.max(...c).toFixed(3):"-",uniqueTypes:o(C).length}},[g,C]),k=r.useMemo(()=>[{category:"direct",current:E.directCurrent,total:E.directCurrent},{category:"indirect",current:E.indirectCurrent,total:E.indirectCurrent},...Object.entries(E.typeCountMap).map(([e,t])=>({category:e,current:t,total:t}))],[E]);s.useEffect(()=>{d?j(d):fetch("http://localhost:8000/neo4j/nodes?activeView=target").then(e=>e.json()).then(j).catch(()=>j([]))},[d]),s.useEffect(()=>{f(C)},[b,C]);const A=r.useCallback((e,t)=>{v(e),f(t)},[]),V=r.useCallback(t=>{P(t);const s={type:"node-click",message:`노드 클릭: ${t.label||t.id}`,connectedCount:t.connectedCount,connectedIps:t.connectedIps,dbInfo:t.dbInfo,timestamp:(new Date).toLocaleTimeString()};N([s]),e&&e(t)},[e]),w=r.useCallback(()=>{I?m("/ActiveResponse/responseeffectvisualization",{state:{selectedNode:I}}):alert("먼저 노드를 선택해주세요.")},[m,I]);return t.jsxs("div",{className:"target-dashboard-root",children:[t.jsxs("div",{className:"dashboard-main-content",children:[t.jsx("div",{className:"top-stats-wrapper",children:t.jsxs("div",{className:"top-stats-inner",children:[t.jsxs("div",{className:"statistics-card-row",children:[t.jsx(c,{dbTitle:"전체 노드 개수",dbValue:C.length,dbSubtext:"네트워크 내 모든 노드",className:"statistics-card"}),t.jsx(c,{dbTitle:"필터링된 노드 개수",dbValue:g.length,dbSubtext:y.isActive?`필터링된 노드 수 (전체: ${C.length})`:"총 노드 수",className:"statistics-card"}),t.jsx(c,{dbTitle:"고유 타입 개수",dbValue:E.uniqueTypes,dbSubtext:"네트워크 내 고유 타입 수",className:"statistics-card"}),t.jsx(c,{dbTitle:"degree_score (평균/최고)",dbValue:`${E.degreeScoreAvg} / ${E.degreeScoreMax}`,dbSubtext:"degree_score의 평균 / 최고값",className:"statistics-card"}),t.jsx(c,{dbTitle:"con_score (평균/최고)",dbValue:`${E.conScoreAvg} / ${E.conScoreMax}`,dbSubtext:"con_score의 평균 / 최고값",className:"statistics-card"})]}),t.jsx("div",{className:"trendchart-row",children:t.jsx("div",{className:"trendchart-wrapper",children:t.jsx(r.Suspense,{fallback:t.jsx(h,{}),children:t.jsx(u,{data:T})})})})]})}),t.jsxs("div",{className:"dashboard-layout",children:[t.jsx("div",{className:"dashboard-left",children:t.jsx(r.Suspense,{fallback:t.jsx(h,{}),children:t.jsx(i,{onConditionChange:A,data:C})})}),t.jsxs("div",{className:"dashboard-center",children:[t.jsx("div",{className:"center-top"}),t.jsx(r.Suspense,{fallback:t.jsx(h,{}),children:t.jsx(n,{dbNodes:g,onNodeClick:V})})]}),t.jsx("div",{className:"dashboard-right",children:t.jsx(r.Suspense,{fallback:t.jsx(h,{}),children:t.jsx(l,{dbData:k})})})]})]}),t.jsxs("aside",{className:"dashboard-aside",children:[t.jsx(r.Suspense,{fallback:t.jsx(h,{}),children:t.jsx(x,{logs:S,activeView:p})}),t.jsx("div",{style:{marginTop:"20px",textAlign:"center"},children:t.jsx("button",{onClick:w,style:{padding:"12px 24px",backgroundColor:I?"#39306b":"#ccc",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:I?"pointer":"not-allowed",width:"100%",transition:"all 0.3s ease"},disabled:!I,children:"대응 효과 분석"})})]})]})}},Symbol.toStringTag,{value:"Module"}));export{_ as T,o as e,d as n};
