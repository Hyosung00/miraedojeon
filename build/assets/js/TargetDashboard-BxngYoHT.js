const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-fZZyIUTh.js","assets/js/mui-vendor-B_Gf3d1M.js","assets/js/react-vendor-4ga91NY9.js","assets/js/index-6eqrfJYO.js","assets/js/chart-vendor-_GeZekKK.js","assets/js/three-vendor-TblYD1mt.js","assets/css/index-DVVUjXCO.css","assets/js/index-DT-3-kNn.js","assets/js/DataTable-DEj8YE8T.js","assets/js/TrendChart-C6aitzvm.js","assets/js/EventLog-DxqHPC_T.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./index-6eqrfJYO.js";import{j as t,C as n,e as i,B as r,G as s,T as o}from"./mui-vendor-B_Gf3d1M.js";import{c as l,u as c,a}from"./react-vendor-4ga91NY9.js";function d(e,t,n){return"number"!=typeof e||isNaN(e)||t===n?1:Math.round(1+99*(e-t)/(n-t))}l.memo(({dbTitle:e,dbValue:n,dbSubtext:i,className:r})=>{const s=e||"Default Title",o=n||"Default Value",l=i||"Default Subtext";return t.jsxs("div",{className:r,children:[t.jsx("div",{className:"statistics-card-value",children:o}),t.jsx("div",{className:"statistics-card-title",children:s}),t.jsx("div",{className:"statistics-card-subtext",children:l})]})}).displayName="StatisticsCard";const x=e=>{if(!e)return[];const t=new Set;return e.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&t.add(e.type)})}),Array.from(t).sort()},h=a.lazy(()=>e(()=>import("./index-fZZyIUTh.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),f=a.lazy(()=>e(()=>import("./index-DT-3-kNn.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),p=a.lazy(()=>e(()=>import("./DataTable-DEj8YE8T.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),g=a.lazy(()=>e(()=>import("./TrendChart-C6aitzvm.js"),__vite__mapDeps([9,1,2,4]))),m=a.lazy(()=>e(()=>import("./EventLog-DxqHPC_T.js"),__vite__mapDeps([10,1,2]))),b=()=>t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#666"},children:"Loading..."}),u=Object.freeze(Object.defineProperty({__proto__:null,default:function({onNodeClick:e,data:d,logs:u=[],activeView:j="target"}){const y=c(),[_,S]=a.useState(d||[]),[v,w]=a.useState([]),[C,I]=a.useState({}),[D,A]=a.useState(u),[P,z]=a.useState(null),k=a.useMemo(()=>Array.isArray(_)?_:_?.nodes||_?.network||[],[_]),W=a.useMemo(()=>k.map(e=>({degree_score:e.src_IP?.degree_score||e.dst_IP?.degree_score||0,con_score:e.src_IP?.con_score||e.dst_IP?.con_score||0})),[k]),E=a.useMemo(()=>{const e=new Set;v.forEach(t=>{t.src_IP&&t.src_IP.ip&&e.add(t.src_IP.ip)});let t=0,n=0;e.forEach(e=>{const i=v.find(t=>t.src_IP&&t.src_IP.ip===e)?.src_IP;i&&"number"==typeof i.degree_score&&(i.degree_score>.5?t+=1:i.degree_score>0&&i.degree_score<=.5&&(n+=1))});const i={};v.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&(i[e.type]=(i[e.type]||0)+1)})});const r=[...k.map(e=>e.src_IP?.degree_score),...k.map(e=>e.dst_IP?.degree_score)].filter(e=>"number"==typeof e),s=[...k.map(e=>e.src_IP?.con_score),...k.map(e=>e.dst_IP?.con_score)].filter(e=>"number"==typeof e);return{directCurrent:t,indirectCurrent:n,typeCountMap:i,degreeScoreAvg:r.length?(r.reduce((e,t)=>e+t,0)/r.length).toFixed(3):"-",degreeScoreMax:r.length?Math.max(...r).toFixed(3):"-",conScoreAvg:s.length?(s.reduce((e,t)=>e+t,0)/s.length).toFixed(3):"-",conScoreMax:s.length?Math.max(...s).toFixed(3):"-",uniqueTypes:x(k).length}},[v,k]),T=a.useMemo(()=>[{category:"direct",current:E.directCurrent,total:E.directCurrent},{category:"indirect",current:E.indirectCurrent,total:E.indirectCurrent},...Object.entries(E.typeCountMap).map(([e,t])=>({category:e,current:t,total:t}))],[E]);l.useEffect(()=>{d?S(d):fetch("http://localhost:8000/neo4j/nodes?activeView=target").then(e=>e.json()).then(S).catch(()=>S([]))},[d]),l.useEffect(()=>{w(k)},[_,k]);const M=a.useCallback((e,t)=>{I(e),w(t)},[]),R=a.useCallback(t=>{z(t);const n={type:"node-click",message:`노드 클릭: ${t.label||t.id}`,connectedCount:t.connectedCount,connectedIps:t.connectedIps,dbInfo:t.dbInfo,timestamp:(new Date).toLocaleTimeString()};A([n]),e&&e(t)},[e]),N=a.useCallback(()=>{P?y("/ActiveResponse/responseeffectvisualization",{state:{selectedNode:P}}):alert("먼저 노드를 선택해주세요.")},[y,P]);return t.jsx(n,{component:"main",role:"main","aria-label":"타겟 대시보드",sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",boxShadow:3,m:0},children:t.jsxs(i,{sx:{p:1,height:"100%","&:last-child":{pb:1},display:"flex",flexDirection:{xs:"column",lg:"row"},gap:1,overflow:"hidden"},children:[t.jsxs(r,{component:"section","aria-label":"대시보드 메인 콘텐츠",sx:{flex:1,display:"flex",flexDirection:"column",gap:2,minWidth:0,overflow:"hidden"},children:[t.jsx(n,{component:"section","aria-label":"통계 및 트렌드 영역",sx:{bgcolor:"transparent",boxShadow:"none",flexShrink:0},children:t.jsx(i,{sx:{p:0,"&:last-child":{pb:0}},children:t.jsxs(r,{sx:{display:"flex",flexDirection:"row",gap:2,alignItems:"center",justifyContent:"space-between",flexWrap:"nowrap",height:"240px",width:"100%"},children:[t.jsx(r,{sx:{flex:"0 0 auto",width:"calc(50% - 8px)",minWidth:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-start"},children:t.jsxs(s,{container:!0,spacing:1,sx:{height:"100%",justifyContent:"flex-start"},children:[t.jsx(s,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx(o,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:k.length}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"전체 노드 개수"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"네트워크 내 모든 노드"})]})})})}),t.jsx(s,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx(o,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:v.length}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"필터링된 노드"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:C.isActive?`(전체: ${k.length})`:"총 노드 수"})]})})})}),t.jsx(s,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx(o,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:E.uniqueTypes}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"고유 타입 개수"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"네트워크 내 타입"})]})})})}),t.jsx(s,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsxs(o,{variant:"h5",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"1.4rem"},children:[E.degreeScoreAvg," / ",E.degreeScoreMax]}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"degree_score"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"평균 / 최고값"})]})})})}),t.jsx(s,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsxs(o,{variant:"h5",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"1.4rem"},children:[E.conScoreAvg," / ",E.conScoreMax]}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"con_score"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"평균 / 최고값"})]})})})})]})}),t.jsx(r,{sx:{flex:"0 0 auto",width:"calc(50% - 8px)",minWidth:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:t.jsx(n,{sx:{width:"100%",height:"100%",bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"16px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(r,{sx:{width:"100%",height:"100%"},children:t.jsx(a.Suspense,{fallback:t.jsx(b,{}),children:t.jsx(g,{data:W})})})})})})]})})}),t.jsxs(r,{sx:{flex:1,display:"flex",flexDirection:{xs:"column",lg:"row"},gap:2,minHeight:0,overflow:"hidden"},children:[t.jsx(n,{component:"section","aria-label":"필터 조건 영역",sx:{width:{xs:"100%",lg:300},flexShrink:0,bgcolor:"#f0edfd",overflow:"auto"},children:t.jsx(i,{children:t.jsx(a.Suspense,{fallback:t.jsx(b,{}),children:t.jsx(f,{onConditionChange:M,data:k})})})}),t.jsx(n,{component:"section","aria-label":"네트워크 그래프 영역",sx:{flex:1,bgcolor:"#f0edfd",overflow:"hidden",minWidth:0},children:t.jsx(i,{sx:{p:0,height:"100%","&:last-child":{pb:0}},children:t.jsx(a.Suspense,{fallback:t.jsx(b,{}),children:t.jsx(h,{dbNodes:v,onNodeClick:R})})})}),t.jsx(n,{component:"section","aria-label":"데이터 테이블 영역",sx:{width:{xs:"100%",lg:300},flexShrink:0,bgcolor:"#f0edfd",overflow:"auto"},children:t.jsx(i,{children:t.jsx(a.Suspense,{fallback:t.jsx(b,{}),children:t.jsx(p,{dbData:T})})})})]})]}),t.jsxs(r,{component:"aside","aria-label":"이벤트 로그 패널",sx:{width:{xs:"100%",lg:300},maxWidth:{xs:"100%",lg:320},display:"flex",flexDirection:"column",gap:2,flexShrink:0,overflow:"hidden"},children:[t.jsx(n,{component:"section","aria-label":"이벤트 로그",sx:{flex:1,bgcolor:"#f0edfd",overflow:"auto",minHeight:0},children:t.jsx(i,{sx:{height:"100%",display:"flex",flexDirection:"column","&:last-child":{pb:2}},children:t.jsx(a.Suspense,{fallback:t.jsx(b,{}),children:t.jsx(m,{logs:D,activeView:j})})})}),t.jsx(n,{component:"section","aria-label":"대응 효과 분석 버튼 영역",sx:{bgcolor:"transparent",boxShadow:"none",flexShrink:0},children:t.jsxs(i,{sx:{p:0},children:[" ",t.jsx(r,{component:"button",onClick:N,disabled:!P,"aria-label":"대응 효과 분석으로 이동",sx:{width:"100%",padding:"12px 24px",backgroundColor:P?"#39306b":"#ccc",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:P?"pointer":"not-allowed",transition:"all 0.3s ease","&:hover:not(:disabled)":{backgroundColor:"#2a1f5a",transform:"translateY(-2px)",boxShadow:"0 4px 12px rgba(57, 48, 107, 0.3)"}},children:"대응 효과 분석"})]})})]})]})})}},Symbol.toStringTag,{value:"Module"}));export{u as T,x as e,d as n};
