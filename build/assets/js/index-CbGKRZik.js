const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-BNVOEdxm.js","assets/js/mui-vendor-DRsyA_VI.js","assets/js/react-vendor-CP5_hn_0.js","assets/js/vis-network-CqERLR1V.js","assets/js/index-BImhcsbi.js","assets/js/chart-vendor-BJu2iTGG.js","assets/js/three-vendor-C8Ar5e6p.js","assets/css/index-DVVUjXCO.css","assets/js/index-DoYlhRFq.js","assets/js/DataTable-cXvr6LyK.js","assets/js/TrendChart-DZb8Qmf2.js","assets/js/EventLog-8voVWaPN.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./index-BImhcsbi.js";import{j as t,C as n,e as i,B as s,G as r,T as o}from"./mui-vendor-DRsyA_VI.js";import{c as l,u as c,a}from"./react-vendor-CP5_hn_0.js";function d(e,t,n){return"number"!=typeof e||isNaN(e)||t===n?1:Math.round(1+99*(e-t)/(n-t))}l.memo(({dbTitle:e,dbValue:n,dbSubtext:i,className:s})=>{const r=e||"Default Title",o=n||"Default Value",l=i||"Default Subtext";return t.jsxs("div",{className:s,children:[t.jsx("div",{className:"statistics-card-value",children:o}),t.jsx("div",{className:"statistics-card-title",children:r}),t.jsx("div",{className:"statistics-card-subtext",children:l})]})}).displayName="StatisticsCard";const x=e=>{if(!e)return[];const t=new Set;return e.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&t.add(e.type)})}),Array.from(t).sort()},h=a.lazy(()=>e(()=>import("./index-BNVOEdxm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),f=a.lazy(()=>e(()=>import("./index-DoYlhRFq.js"),__vite__mapDeps([8,1,2,4,5,6,7]))),p=a.lazy(()=>e(()=>import("./DataTable-cXvr6LyK.js"),__vite__mapDeps([9,1,2,4,5,6,7]))),g=a.lazy(()=>e(()=>import("./TrendChart-DZb8Qmf2.js"),__vite__mapDeps([10,1,2,5]))),m=a.lazy(()=>e(()=>import("./EventLog-8voVWaPN.js"),__vite__mapDeps([11,1,2,4,5,6,7]))),u=()=>t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#666"},children:"Loading..."}),j=Object.freeze(Object.defineProperty({__proto__:null,default:function({onNodeClick:e,data:d,logs:j=[],activeView:b="target"}){const y=c(),[_,S]=a.useState(d||[]),[v,w]=a.useState([]),[I,C]=a.useState({}),[D,A]=a.useState(j),[P,z]=a.useState(null),W=a.useMemo(()=>Array.isArray(_)?_:_?.nodes||_?.network||[],[_]),E=a.useMemo(()=>W.map(e=>({degree_score:e.src_IP?.degree_score||e.dst_IP?.degree_score||0,con_score:e.src_IP?.con_score||e.dst_IP?.con_score||0})),[W]),k=a.useMemo(()=>{const e=new Set;v.forEach(t=>{t.src_IP&&t.src_IP.ip&&e.add(t.src_IP.ip)});let t=0,n=0;e.forEach(e=>{const i=v.find(t=>t.src_IP&&t.src_IP.ip===e)?.src_IP;i&&"number"==typeof i.degree_score&&(i.degree_score>.5?t+=1:i.degree_score>0&&i.degree_score<=.5&&(n+=1))});const i={};v.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&(i[e.type]=(i[e.type]||0)+1)})});const s=[...W.map(e=>e.src_IP?.degree_score),...W.map(e=>e.dst_IP?.degree_score)].filter(e=>"number"==typeof e),r=[...W.map(e=>e.src_IP?.con_score),...W.map(e=>e.dst_IP?.con_score)].filter(e=>"number"==typeof e);return{directCurrent:t,indirectCurrent:n,typeCountMap:i,degreeScoreAvg:s.length?(s.reduce((e,t)=>e+t,0)/s.length).toFixed(3):"-",degreeScoreMax:s.length?Math.max(...s).toFixed(3):"-",conScoreAvg:r.length?(r.reduce((e,t)=>e+t,0)/r.length).toFixed(3):"-",conScoreMax:r.length?Math.max(...r).toFixed(3):"-",uniqueTypes:x(W).length}},[v,W]),M=a.useMemo(()=>[{category:"direct",current:k.directCurrent,total:k.directCurrent},{category:"indirect",current:k.indirectCurrent,total:k.indirectCurrent},...Object.entries(k.typeCountMap).map(([e,t])=>({category:e,current:t,total:t}))],[k]);l.useEffect(()=>{d?S(d):fetch("http://localhost:8000/neo4j/nodes?activeView=target").then(e=>e.json()).then(S).catch(()=>S([]))},[d]),l.useEffect(()=>{w(W)},[_,W]);const T=a.useCallback((e,t)=>{C(e),w(t)},[]),N=a.useCallback(t=>{z(t);const n={type:"node-click",message:`노드 클릭: ${t.label||t.id}`,connectedCount:t.connectedCount,connectedIps:t.connectedIps,dbInfo:t.dbInfo,timestamp:(new Date).toLocaleTimeString()};A([n]),e&&e(t)},[e]);return a.useCallback(()=>{P?y("/ActiveResponse/responseeffectvisualization",{state:{selectedNode:P}}):alert("먼저 노드를 선택해주세요.")},[y,P]),t.jsx(n,{component:"main",role:"main","aria-label":"타겟 대시보드",sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",boxShadow:3,m:0},children:t.jsxs(i,{sx:{p:1,height:"100%","&:last-child":{pb:1},display:"flex",flexDirection:{xs:"column",lg:"row"},gap:1,overflow:"hidden"},children:[t.jsxs(s,{component:"section","aria-label":"대시보드 메인 콘텐츠",sx:{flex:1,display:"flex",flexDirection:"column",gap:2,minWidth:0,overflow:"hidden"},children:[t.jsx(n,{component:"section","aria-label":"통계 및 트렌드 영역",sx:{bgcolor:"transparent",boxShadow:"none",flexShrink:0},children:t.jsx(i,{sx:{p:0,"&:last-child":{pb:0}},children:t.jsxs(s,{sx:{display:"flex",flexDirection:"row",gap:2,alignItems:"center",justifyContent:"space-between",flexWrap:"nowrap",height:"240px",width:"100%"},children:[t.jsx(s,{sx:{flex:"0 0 auto",width:"calc(50% - 8px)",minWidth:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-start"},children:t.jsxs(r,{container:!0,spacing:1,sx:{height:"100%",justifyContent:"flex-start"},children:[t.jsx(r,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx(o,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:W.length}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"전체 노드 개수"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"네트워크 내 모든 노드"})]})})})}),t.jsx(r,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx(o,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:v.length}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"필터링된 노드"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:I.isActive?`(전체: ${W.length})`:"총 노드 수"})]})})})}),t.jsx(r,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx(o,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:k.uniqueTypes}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"고유 타입 개수"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"네트워크 내 타입"})]})})})}),t.jsx(r,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsxs(o,{variant:"h5",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"1.4rem"},children:[k.degreeScoreAvg," / ",k.degreeScoreMax]}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"degree_score"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"평균 / 최고값"})]})})})}),t.jsx(r,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:t.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:t.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsxs(o,{variant:"h5",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"1.4rem"},children:[k.conScoreAvg," / ",k.conScoreMax]}),t.jsx(o,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"con_score"}),t.jsx(o,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"평균 / 최고값"})]})})})})]})}),t.jsx(s,{sx:{flex:"0 0 auto",width:"calc(50% - 8px)",minWidth:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:t.jsx(n,{sx:{width:"100%",height:"100%",bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"16px"},children:t.jsx(i,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(s,{sx:{width:"100%",height:"100%"},children:t.jsx(a.Suspense,{fallback:t.jsx(u,{}),children:t.jsx(g,{data:E})})})})})})]})})}),t.jsxs(s,{sx:{flex:1,display:"flex",flexDirection:{xs:"column",lg:"row"},gap:2,minHeight:0,overflow:"hidden"},children:[t.jsx(n,{component:"section","aria-label":"필터 조건 영역",sx:{width:{xs:"100%",lg:300},flexShrink:0,bgcolor:"#f0edfd",overflow:"auto"},children:t.jsx(i,{children:t.jsx(a.Suspense,{fallback:t.jsx(u,{}),children:t.jsx(f,{onConditionChange:T,data:W})})})}),t.jsx(n,{component:"section","aria-label":"네트워크 그래프 영역",sx:{flex:1,bgcolor:"#f0edfd",overflow:"hidden",minWidth:0},children:t.jsx(i,{sx:{p:0,height:"100%","&:last-child":{pb:0}},children:t.jsx(a.Suspense,{fallback:t.jsx(u,{}),children:t.jsx(h,{dbNodes:v,onNodeClick:N})})})}),t.jsx(n,{component:"section","aria-label":"데이터 테이블 영역",sx:{width:{xs:"100%",lg:300},flexShrink:0,bgcolor:"#f0edfd",overflow:"auto"},children:t.jsx(i,{children:t.jsx(a.Suspense,{fallback:t.jsx(u,{}),children:t.jsx(p,{dbData:M})})})})]})]}),t.jsx(s,{component:"aside","aria-label":"이벤트 로그 패널",sx:{width:{xs:"100%",lg:300},maxWidth:{xs:"100%",lg:320},display:"flex",flexDirection:"column",gap:2,flexShrink:0,overflow:"hidden"},children:t.jsx(n,{component:"section","aria-label":"이벤트 로그",sx:{flex:1,bgcolor:"#f0edfd",overflow:"auto",minHeight:0},children:t.jsx(i,{sx:{height:"100%",display:"flex",flexDirection:"column","&:last-child":{pb:2}},children:t.jsx(a.Suspense,{fallback:t.jsx(u,{}),children:t.jsx(m,{logs:D,activeView:b,selectedNode:P})})})})})]})})}},Symbol.toStringTag,{value:"Module"}));export{x as e,j as i,d as n};
